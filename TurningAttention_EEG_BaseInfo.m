%% Basic information used to streamline the pipeline
set(0, 'DefaultAxesFontName', 'Futura PT');
%% For EEG pipeline
forICA = ['ICAdataset'];
forERP = ['ERPdataset'];

%{'C:\_TurningAttentionData'}

datapathOrigin = {'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\1\\1',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\2\\2',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\3\\3',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\4\\4',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\5\\5',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\6\\6',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\7\\7',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\8\\8',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\9\\9',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\10\\10',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\11\\11',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\12\\12',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\13\\13',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\14\\14',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\15\\15',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\16\\16',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\17\\17',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\18\\18',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\19\\19',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\20\\20'};
datapathSave = {'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\1',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\2',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\3',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\4',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\5',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\6',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\7',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\8',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\9',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\10',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\11',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\12',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\13',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\14',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\15',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\16',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\17',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\18',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\19',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\Eval\\20'};
% datapathERSP = {'C:\Users\zadj\OneDrive - Aalborg Universitet\Dokumenter\_Analysis\DataFolder\Eval\EEGLAB_Studies\'};
datapathStudy = {'C:\Users\zadj\OneDrive - Aalborg Universitet\Dokumenter\_Analysis\DataFolder\Eval\EEGLAB_Studies\'};

RejectedComponents{1} = [1:3 5 10 11 13 15:16 19:22 24 27:28 33:39 43 46 48:56 58:67 69 70 73 74 76:79 82:83 85 90:92 94 96 100:120];
RejectedComponents{3} = [1:30 32 33 35:39 41 43:61 63 66:74 76:78 80 81 83 84 86:95 97:99 101:113];
RejectedComponents{4} = [1:3 5 10:11 14:15 18:19 24 26:27 31:37 39 41:53 55 56 58:80 82 83 85:88 90 91 93:95 98 103 105:113 115];
RejectedComponents{5} = [1:22 24:103 105:109];
RejectedComponents{6} = [1:3 5 7 15 20 23 25 27 28 30 31 32 34 37:40 42:44 46 48 50:57 59 60 62:69 72 75 78:84 88:91 96 106:109 ];
RejectedComponents{7} = [1:10 12:19 23:25 29:30 32:33 35:42 45 46 49 54 57 59:67 69:75 77 82:100 102:105 107:111 113:115];
RejectedComponents{8} = [1:5 7:19 21:40 43:45 47:49 51:59 62 65:80 82:91 93:100 102:111 113:115];
RejectedComponents{9} = [1:2 8 13 21:23 31:33 35 39:41 43 46 51 59:60 62:64 69 71 76 90 94 100 109 110];
RejectedComponents{10} = [1:3 5 13:14 16:18 21:35 39 41:42 44:45 47:58 60 61 63:69 72:75 81:83 88 90:94 97:109];
RejectedComponents{11} = [1 2 4:6 8 10 12 16 23:24 28 32:33 36 39 42:43 45:47 49:52 54:56 60:63 65:67 71 73 75:78 81:86 90:95 97:105 112 114 115];
RejectedComponents{12} = [1:4 6:11 13:14 16:18 20:22 24 26 28 30:32 34:35 38:42 44:45 47:50 52 54:56 58:60 62:64 67:70 72 74 75 77 79:81 85:88 90 92 95 98:101 103 106 111:112];
RejectedComponents{13} = [1:5 7 10 12 14 16 17 20:22 28:34 36 40:42 44 46 48 50:55 57:58 63 65 66 70:72 74:75 83 86 88 94 101 111 112];
RejectedComponents{14} = [1:6 8:15 17:27 29:30 31:47 49:56 58 60 62:64 66:72 74:78 82:111];
RejectedComponents{15} = [1:7 11 13 18:20 23:25 27:32 34:35 37:39 42 48:50 52 55:57 59 61 66:67 69:75 78:80 82:84 86 89:95 102:103 105:110 118];
RejectedComponents{16} = [1:6 8 20:23 25:34 36:37 39:40 46 48:50 52:55 62:66 69 71:75 79:80 82:85 88:89 91:93 97 99 101:104 109 111:112 114];
RejectedComponents{17} = [1:6 9 17:18 25 29:30 32 34:37 39 41:47 50:53 55:59 62:64 66:74 76:77 79:80 82:86 88:90 92:95 98 100:101 103 109:111];
RejectedComponents{18} = [1:3 7 9 13:15 18 20 22 24 26:27 29:30 33 36 38:41 48 56 58:60 64 68:70 78 81:82 84:86 95 98 102 107 114];
RejectedComponents{19} = [1 2 4 5 8 14:18 20:21 23:25 27:28 30:45 49:53 55:60 64:65 67:70 72:75 78:90 93:94 100 106:107];
RejectedComponents{20} = [1:4 6:10 13 14 21:22 24 27 29:32 34 38:40 43:44 46:48 52:56 59:72 74:77 79 82:84 88 110];

%% For Unfold
% temp = [];
% for i = 1:size(EEG.chanlocs,2)
%     temp = [temp, EEG.chanlocs(i).Z];
% end

clear equidistChans
% tempEEG.chanlocs = EEG.chanlocs;
equidistChans.chanlocs.labels = ["g1"	"FTT9h"	"g3"	"g4"	"g5"	"g6"	"g7"	"g8"	"g9"	"g10"	"g11"	"g12"	"g13"	"g14"	"g15"	"g16"	"g17"	"g18"	"g19"	"g20"	"g21"	"g22"	"g23"	"g24"	"g25"	"FTT10h"	"g27"	"g28"	"g29"	"g30"	"g31"	"g32"	"AFz"	"y2"	"y3"	"y4"	"y5"	"y6"	"y7"	"y8"	"Cz"	"y10"	"y11"	"y12"	"y13"	"y14"	"y15"	"y16"	"y17"	"y18"	"y19"	"C6"	"y21"	"y22"	"y23"	"y24"	"y25"	"y26"	"y27"	"y28"	"y29"	"y30"	"y31"	"y32"	"r1"	"r2"	"r3"	"r4"	"r5"	"r6"	"r7"	"r8"	"r9"	"r10"	"r11"	"r12"	"r13"	"r14"	"r15"	"r16"	"r17"	"r18"	"r19"	"C5"	"r21"	"r22"	"r23"	"r24"	"r25"	"r26"	"r27"	"POz"	"r29"	"r30"	"r31"	"r32"	"w1"	"w2"	"w3"	"w4"	"w5"	"w6"	"w7"	"w8"	"w9"	"w10"	"w11"	"w12"	"w13"	"w14"	"w15"	"w16"	"w17"	"w18"	"w19"	"w20"	"w21"	"w22"	"w23"	"w24"	"w25"	"w26"	"w27"	"w28"	"w29"	"w30"	"w31"	"w32"];
equidistChans.chanlocs.X = [18.1481500000000	12.5249500000000	48.0886000000000	37.1213000000000	15.2771500000000	37.2055000000000	14.7790000000000	42.3062500000000	61.9128500000000	67.4873000000000	77.2446500000000	90.6044500000000	101.052750000000	102.444900000000	113.723000000000	73.4303000000000	114.540500000000	105.491300000000	102.327800000000	91.6471000000000	79.6308500000000	67.5296500000000	49.9838500000000	21.0271500000000	38.0807500000000	12.8832000000000	15.2605500000000	38.9671500000000	60.0978500000000	11.8737500000000	42.9970500000000	73.5343000000000	111.181150000000	104.412050000000	93.4133000000000	64.7127000000000	77.4006500000000	64.3979000000000	57.5816000000000	44.2574500000000	20.3323750000000	-8.64115000000001	34.3160500000000	5.26910000000000	18.4189500000000	30.8019000000000	37.7870000000000	10.3743500000000	56.3361500000000	29.8030000000000	38.4344500000000	11.7910500000000	45.1863500000000	35.7290000000000	18.6274500000000	5.87685000000000	94.4672000000000	74.5674000000000	64.9771000000000	49.4444000000000	64.5410500000000	87.5436500000000	79.6837500000000	105.008950000000	1.73025000000001	-7.26495000000000	-26.0590500000000	-47.8812500000000	-64.1843000000000	-44.2478000000000	-81.1152000000000	-62.1526500000000	-28.6400000000000	-36.9028000000000	-60.8818000000000	-78.7564500000000	-17.6119000000000	-37.6597000000000	-12.5351000000000	-33.7597000000000	-25.5889500000000	-10.1150000000000	-37.2616000000000	-15.1683000000000	-57.9422000000000	-39.9080000000001	-76.4887000000000	-61.1391000000000	-45.3132000000000	-76.2450500000000	-60.4989500000000	-81.4304000000000	0.381599999999997	-25.8149550000000	-8.43905000000000	-28.1345500000000	-92.9927500000000	-99.5027000000000	-88.3760000000000	-91.3284000000000	-99.8298000000000	-100.755000000000	-100.616700000000	-95.3534500000000	-86.1231000000000	-77.9886000000000	-73.2664500000000	-52.5566500000000	-60.1362000000000	-66.9699500000000	-44.3247000000000	-44.9139500000000	-38.0358500000000	-38.9172000000000	-59.3530000000000	-54.1781000000000	-44.4437500000000	-65.6838000000000	-71.2201500000000	-77.3287000000000	-86.3865500000000	-94.0745500000000	-97.5689500000000	-82.2387000000000	-101.211450000000	-96.1513000000000	-94.7253000000000	-89.7120500000000];
equidistChans.chanlocs.Y = [84.9774000000000	84.9294500000000	78.8950000000000	80.5747500000000	81.6997000000000	79.4402000000000	76.8866000000000	72.1380500000000	69.3161500000000	60.8301500000000	66.6956000000000	44.8925500000000	44.9970500000000	20.0534000000000	14.5045000000000	33.2869000000000	-17.9274000000000	-16.5907500000000	-46.7214500000000	-43.8199500000000	-66.7989500000000	-60.4672000000000	-80.2904500000000	-87.8946500000000	-80.7595000000000	-85.7779500000000	-81.1073500000000	-76.4327000000000	-68.1142500000000	-75.2867500000000	-67.9875000000000	-28.0395500000000	-2.23580000000000	28.0749500000000	14.8923500000000	24.8305000000000	44.1682000000000	68.5895500000000	59.1984000000000	45.1632000000000	-3.54848299999999	-2.75290000000001	22.4627000000000	21.1938000000000	51.8540500000000	69.8938500000000	79.0600500000000	82.7734500000000	-65.8597500000000	-76.9673000000000	-83.5905500000000	-88.1549000000000	-50.9648500000000	-29.2176000000000	-59.2265000000000	-30.7234500000000	-19.9559000000000	-2.15015000000000	-30.8204000000000	-2.25345000000000	-73.5297500000000	-56.9994000000000	-48.6386000000000	-33.1191500000000	71.1420500000000	45.8997500000000	60.6569500000000	42.2309500000000	49.1208500000000	67.7495000000000	45.3217500000000	64.7067500000000	22.6630500000000	-4.76505000000000	9.20019999999997	20.9768499999999	79.1283500000000	78.4134500000000	85.1601000000000	82.5465500000000	-84.6176500000000	-88.0479000000000	-80.8057000000000	-84.5990500000000	-70.4640500000000	-74.5094500000000	-54.0467500000000	-57.6542000000000	-50.7921000000000	-34.0106500000000	-19.9363000000000	-5.45809999999999	-77.6673500000000	-68.1600000000000	-52.8251000000000	-33.5964000000000	19.4223500000000	18.6802000000000	43.7527000000000	40.0141500000001	16.9255000000000	-2.61252500000001	-3.21015000000000	24.7105500000000	44.6830500000000	56.1390500000000	60.7040500000000	74.7424000000000	70.2834000000000	62.5504000000000	78.8438500000000	72.5877499999999	-71.2516000000000	-79.4052500000000	-63.7617500000000	-72.6700000000000	-79.0650000000000	-67.5866500000000	-61.3237500000000	-52.0727500000000	-46.6058500000000	-30.1318000000000	-24.3803000000000	-52.9959000000000	-3.90609999999998	-30.2874000000000	-6.62619999999996	-32.5808500000000];
equidistChans.chanlocs.Z = [53.8498500000000	29.7135000000000	49.9721000000000	25.5640500000000	0.879150000000000	-2.38145000000000	-23.5698500000000	-28.6675000000000	-5.23170000000000	24.2932000000000	48.3462000000000	28.8726000000000	47.3543500000000	21.4845500000000	45.6604500000000	-29.9517000000000	42.8202000000000	20.3456500000000	44.3658500000000	21.8049500000000	42.0964000000000	19.3942500000000	42.9999500000000	46.3904500000000	17.0995500000000	20.6914000000000	-7.94430000000000	-10.1477500000000	-10.2177500000000	-31.4050000000000	-37.2370500000000	-36.4207000000000	72.5523000000000	74.1231500000000	101.725750000000	123.495500000000	100.069000000000	73.8250000000000	100.879400000000	124.286000000000	144.015750000000	151.911000000000	140.858500000000	148.917500000000	130.378000000000	104.970350000000	76.7691000000000	83.0342500000000	97.1654500000000	99.2563500000000	70.0817500000000	74.1351500000000	120.848500000000	138.311500000000	126.674500000000	146.801500000000	100.317200000000	122.016500000000	121.715500000000	137.294500000000	68.1732500000000	69.5506000000000	96.4366000000000	70.7677000000000	113.577300000000	138.927000000000	122.554350000000	128.184500000000	106.443800000000	99.7262500000000	82.9652000000000	77.8318000000000	146.044000000000	146.009500000000	130.593500000000	110.024650000000	90.3324500000000	69.3432000000000	60.7069500000000	40.3564500000000	31.0481000000000	52.9984500000000	62.8508000000000	81.9152500000000	70.3906000000000	92.4974500000000	77.3472500000000	100.610500000000	124.198000000000	106.856200000000	128.796500000000	110.358600000000	107.154100000000	115.907000000000	136.036000000000	143.063000000000	86.7525000000000	59.9189000000000	59.0746000000000	34.6543000000000	34.8645000000000	33.8803000000000	11.8695500000000	12.1960000000000	10.9250000000000	30.3095500000000	54.5899000000000	48.7227000000000	23.3529000000000	2.17965000000000	16.9682000000000	-8.16305000000000	-18.8247000000000	5.64950000000000	-8.50375000000000	13.5264000000000	37.9452000000000	45.8319000000000	22.0966500000000	2.40955000000000	27.9305500000000	9.44210000000000	33.0495500000000	52.2181000000000	59.2906500000000	56.4459000000000	86.1387500000000	83.2204000000000];

temp = []; %= struct('labels', {}, 'X', {}, 'Y', {}, 'Z', {});
for i = 1:size(equidistChans.chanlocs.labels,2)
    temp.chanlocs(i).labels = convertStringsToChars(equidistChans.chanlocs.labels(i));
    temp.chanlocs(i).X = equidistChans.chanlocs.X(i);
    temp.chanlocs(i).Y = equidistChans.chanlocs.Y(i);
    temp.chanlocs(i).Z = equidistChans.chanlocs.Z(i);
end
equidistChans = temp;

%% For RT pipeline
datapathSaveRT = {'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\RT\\VP1\\',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\RT\\1\\'};

datapathOriginRT = {'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\VP1',...
    'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\1'};

%% For SPM12 pipeline
datapathSPM = {'C:\\Users\\zadj\\OneDrive - Aalborg Universitet\\Dokumenter\\_Analysis\\DataFolder\\SPM\\VP1\\'};